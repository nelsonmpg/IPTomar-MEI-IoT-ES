<div class="card  card-outline-secundary">
  <div class="card-block">
    <%=form_for @project do |f| %>

      <% if project.errors.any? %>
          <div id="error_explanation" class="alert alert-warning" role="alert">
              <h2> Existem erros no formulário:</h2>
              <ul>
                  <% project.errors.full_messages.each do |message| %>
                      <li>
                          <%= message %>
                      </li>
                      <% end %>
              </ul>
          </div>
      <% end %>

      <div class=" col-md-12">

            <div class="row">
                <fieldset class="form-group has-success col-md-12">
                    <%=f.label :"Titulo do Projeto" %>
                    <%=f.text_field :title, class: 'form-control' %>
                </fieldset>
            </div>

            <div class="row">
                <fieldset class="form-group has-success col-md-12">
                    <%=f.label :"Resumo do Projeto" %>
                    <%=f.text_area :resume, class: 'form-control', rows: 15 %>
                </fieldset>
            </div>

            <div class="row">
                <div class="col-md-12 text-center">
                    <label class="custom-control custom-checkbox mr-5">
                        <%=f.check_box :featured, class: 'custom-control-input' %>
                        <%=f.label :"Destacar", class: 'custom-control-description' %>
                        <span class="custom-control-indicator"></span>
                    </label>

                    <label class="custom-control custom-checkbox ml-5">
                        <%=f.check_box :finished, class: 'custom-control-input' %>
                        <%=f.label :"Projecto acabado", class: 'custom-control-description' %>
                        <span class="custom-control-indicator"></span>
                    </label>
                </div>
            </div>
            

            <div class="row">
                <fieldset class="form-group has-success col-md-6">
                    <%=f.label :"Data do Projeto" %></br>
                    <%=f.date_select :date, {:start_year => 2010, :end_year => Date.today.year + 1, include_blank: true}, {class: 'form-control custom-select widthAuto'} %>
                </fieldset> 
                
                <fieldset class="form-group has-success col-md-2">
                    <%=f.label :"Nota" %>
                    <%=f.select( :grade, options_for_select(1..20, :selected => f.object.grade), {include_blank: true}, {class: 'form-control'}) %>
                </fieldset>  
            </div>

            <div class="row">
                <fieldset class="form-group has-success col-md-12">
                    <%=f.label :"Link GitHub" %>
                    <%=f.text_field :github, class: 'form-control' %>
                </fieldset>
            </div>
                
            <div class="row">
                <fieldset class="form-group has-success col-md-12">
                    <%=f.label :"Url do Projeto" %>
                    <%=f.text_field :project_url, class: 'form-control' %>
                </fieldset>
            </div>
            
                
            <div class="row">
                <fieldset class="form-group has-success col-md-6">
                    <%= f.fields_for :courses, @project.course_unit do |course| %>
                        <%=course.label :course_id, "Curso" %></br>
                        <%=course.collection_select :course_id, Course.order(:name),:id, :name, {prompt: "Seleccione uma opção"}, {class: "form-control"} %>
                    <% end %>
                </fieldset>

                <fieldset class="form-group has-success col-md-6">
                    <%= f.label :course_unit_id, "Unidade Curricular" %></br>
                    <%= f.grouped_collection_select :course_unit_id, Course.order(:name), :course_units, :name, :id, :name, {prompt: "Seleccione uma opção"}, {class: "form-control "} %>
                </fieldset>
            </div>


            
            <div class="row">
                <fieldset class="form-group has-success col-md-12">
                    <%=f.label :tag_list, 'Tags (separar por vírgulas)' %>
                    <%=f.text_field :tag_list, :value => @project.tag_list.to_s, class: 'form-control' %>
                </fieldset>
            </div>

            <hr>

            <%= f.fields_for :presentation do |ff| %>       
                <!-- se querem usar datepickers decentes vejam e testem:
                https://github.com/Nerian/bootstrap-datepicker-rails
                e 
                https://github.com/TrevorS/bootstrap3-datetimepicker-rails
                ou leiam mais. O que estava actualmente era só um campo de texto normal, o que vocês viam era uma feature do chrome mas nos outros browsers não aparece nada disso.
                -->
                <div class="row">
                    <fieldset class="form-group has-success col-md-7">
                        <%= ff.label :date, "Data de Apresentação" %></br>
                        <%=ff.datetime_select :date, {:start_year => 2010, :end_year => Date.today.year + 1, include_blank: true, type: "datetime-local"}, {class: 'form-control widthAuto d-inline'} %>
                    </fieldset>

                    <fieldset class="form-group has-success col-md-5">
                        <%= ff.label :room, "Sala de Apresentação" %>
                        <%= ff.text_field :room, class: 'form-control' %>
                    </fieldset>
                </div>

                <div id="presentation-slides" class="row">
                    <h4><%= f.label :slides, "Escolha um ficheiro: " %></h4>
                    <fieldset class="form-group col-md-12">
                        <%#><%= ff.fields_for :presentation, "Slides da Apresentação" %>
                        <%= render 'presentation_fields', f: ff %>
                        <div id="add-slides" class="links mt-2">
                            <%= link_to_add_association 'Adicionar Apresentação', f, :presentation, :force_non_association_create => true, class:"btn btn-info btn-sm" %>
                        </div>
                    </fieldset>
                </div>
            <% end %>

            <hr>

            <div class="row">
                <h4>Documentos:</h4></br>
                    <fieldset class="form-group col-md-12">
                        <%= f.fields_for :documents do |document| %>
                            <%= render 'document_fields', f: document %> 
                        <% end %>
                        <div class="links mt-1">
                            <%= link_to_add_association 'Adicionar Ficheiro', f, :documents, class:"btn btn-info btn-sm" %>
                        </div>
                    </fieldset>
            </div>

            <hr>
            <div class="row">
                <h4>Imagens:</h4></br>
                    <fieldset class="form-group col-md-12">
                        <%= f.fields_for :project_images do |projectimage| %>
                            <%= render 'project_image_fields', f: projectimage %>
                        <% end %>
                        <%#<%= image_tag @project.project_images.image_file_name(:medium), :class => "rounded" %>
                        <div class="links">
                            <%= link_to_add_association 'Adicionar Imagem', f, :project_images, class:"btn btn-info btn-sm" %>
                        </div>
                    </fieldset>
            </div>

            <div class="row mt-2">
                <div class="col-md-12">
                    <%= button_tag type: 'submit', class: "btn btn-outline-success float-right" do %>
                        <i class="fa fa-floppy-o" aria-hidden="true"></i> Salvar Projeto
                    <% end %>
                    <%= link_to '<i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Voltar'.html_safe, projects_path, class: "btn btn-outline-info float-left" %>
                </div>
            </div>

            </div>
        <% end %>
        
    </div>
</div>
